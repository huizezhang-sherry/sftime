<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Benedikt Gräler, Edzer Pebesma" />

<meta name="date" content="2022-01-21" />

<title>Introduction to sftime</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to sftime</h1>
<h4 class="author">Benedikt Gräler, Edzer Pebesma</h4>
<h4 class="date">2022-01-21</h4>



<p>The package sftime extends the package sf to store and handle spatiotemporal data. To this end, sftime introduces a dedicated time column which stores the temporal information alongside the simple features column of sf objects.</p>
<p>The time column can consists of any collection of a class that allows to be sorted - reflecting the native order of time. Besides well-known time classes such as <code>Date</code> or <code>POSIXct</code>, it also allows for custom class definitions, that provide the necessary dedicated functions to make the sorting procedures work (we will see a example below).</p>
<p>This vignette is meant to briefly explain and illustrate the ideas and decisions behind the implementations of sftime.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(sftime)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#&gt; Loading required package: sf</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt; Warning: package &#39;sf&#39; was built under R version 4.0.5</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; Linking to GEOS 3.9.1, GDAL 3.2.1, PROJ 7.2.1</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(sf)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(stars)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; Warning: package &#39;stars&#39; was built under R version 4.0.5</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt; Loading required package: abind</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">library</span>(spacetime)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; Warning: package &#39;spacetime&#39; was built under R version 4.0.5</span></span></code></pre></div>
<div id="the-sftime-class" class="section level2">
<h2>The <code>sftime</code> class</h2>
<p>An <code>sftime</code> object is an <code>sf</code> object with an additional time column which contains the temporal information alongside the simple features column. This allows it to handle irregular and regular temporal information.</p>
<p>For spatiotemporal data with regular temporal data, the package stars is developed as a powerful alternative (e.g. time series of remote sensing imagery, regular measurements of entire measurement network).</p>
<p><code>sftime</code> objects can be constructed directly from <code>sfc</code> objects by combining them with a vector representing temporal information:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># example sfc object</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>x_sfc &lt;-<span class="st"> </span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st">  </span>sf<span class="op">::</span><span class="kw">st_sfc</span>(</span>
<span id="cb2-4"><a href="#cb2-4"></a>    sf<span class="op">::</span><span class="kw">st_point</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>), </span>
<span id="cb2-5"><a href="#cb2-5"></a>    sf<span class="op">::</span><span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)), </span>
<span id="cb2-6"><a href="#cb2-6"></a>    sf<span class="op">::</span><span class="kw">st_point</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>), </span>
<span id="cb2-7"><a href="#cb2-7"></a>    sf<span class="op">::</span><span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb2-8"><a href="#cb2-8"></a>  )</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co"># create an sftime object directly from x_sfc</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>x_sftime1 &lt;-<span class="st"> </span>sftime<span class="op">::</span><span class="kw">st_sftime</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, x_sfc, <span class="dt">time =</span> <span class="kw">Sys.time</span>()<span class="op">-</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">3600</span> <span class="op">*</span><span class="st"> </span><span class="dv">24</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># first create the sf object and from this the sftime object</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>x_sf &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_sf</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, x_sfc, <span class="dt">time =</span> x_sftime1<span class="op">$</span>time)</span>
<span id="cb2-15"><a href="#cb2-15"></a>x_sftime2 &lt;-<span class="st"> </span>sftime<span class="op">::</span><span class="kw">st_sftime</span>(x_sf)</span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a>x_sftime3 &lt;-<span class="st"> </span>sftime<span class="op">::</span><span class="kw">st_as_sftime</span>(x_sf) <span class="co"># alernative option</span></span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="kw">identical</span>(x_sftime1, x_sftime2)</span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="kw">identical</span>(x_sftime1, x_sftime3)</span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb2-23"><a href="#cb2-23"></a></span>
<span id="cb2-24"><a href="#cb2-24"></a>x_sftime1</span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co">#&gt; Spatiotemporal feature collection with 4 features and 1 field</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co">#&gt; Geometry type: POINT</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="co">#&gt; Bounding box:  xmin: 1 ymin: 1 xmax: 2 ymax: 3</span></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co">#&gt; CRS:           NA</span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co">#&gt; Time column with class: &#39;POSIXt&#39;.</span></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="co">#&gt; Ranging from 2022-01-18 13:02:36 to 2022-01-21 13:02:36.</span></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co">#&gt; 2022-01-21 13:02:36</span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="co">#&gt; 2022-01-20 13:02:36</span></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="co">#&gt; 2022-01-19 13:02:36</span></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="co">#&gt; 2022-01-18 13:02:36</span></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="co">#&gt;   a    geometry                time</span></span>
<span id="cb2-37"><a href="#cb2-37"></a><span class="co">#&gt; 1 1 POINT (1 2) 2022-01-21 13:02:36</span></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="co">#&gt; 2 2 POINT (1 3) 2022-01-20 13:02:36</span></span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="co">#&gt; 3 3 POINT (2 3) 2022-01-19 13:02:36</span></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="co">#&gt; 4 4 POINT (2 1) 2022-01-18 13:02:36</span></span></code></pre></div>
<p>Functions to get or set the time column of an <code>sftime</code> object.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># get the values from the time column</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">st_time</span>(x_sftime1)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; [1] &quot;2022-01-21 13:02:36 CET&quot; &quot;2022-01-20 13:02:36 CET&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; [3] &quot;2022-01-19 13:02:36 CET&quot; &quot;2022-01-18 13:02:36 CET&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># set the values in the time column</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">st_time</span>(x_sftime1) &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">st_time</span>(x_sftime1)</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; [1] &quot;2022-01-21 13:02:36 CET&quot; &quot;2022-01-21 13:02:36 CET&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; [3] &quot;2022-01-21 13:02:36 CET&quot; &quot;2022-01-21 13:02:36 CET&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co"># drop the time column to convert an sftime object to an sf object</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="kw">st_drop_time</span>(x_sftime1)</span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt; Simple feature collection with 4 features and 1 field</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt; Geometry type: POINT</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt; Bounding box:  xmin: 1 ymin: 1 xmax: 2 ymax: 3</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt; CRS:           NA</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#&gt;   a    geometry</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#&gt; 1 1 POINT (1 2)</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#&gt; 2 2 POINT (1 3)</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt; 3 3 POINT (2 3)</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">#&gt; 4 4 POINT (2 1)</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>x_sftime1</span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co">#&gt; Spatiotemporal feature collection with 4 features and 1 field</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">#&gt; Geometry type: POINT</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="co">#&gt; Bounding box:  xmin: 1 ymin: 1 xmax: 2 ymax: 3</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="co">#&gt; CRS:           NA</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co">#&gt; Time column with class: &#39;POSIXt&#39;.</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="co">#&gt; Ranging from 2022-01-21 13:02:36 to 2022-01-21 13:02:36.</span></span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="co">#&gt; 2022-01-21 13:02:36</span></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="co">#&gt; 2022-01-21 13:02:36</span></span>
<span id="cb3-34"><a href="#cb3-34"></a><span class="co">#&gt; 2022-01-21 13:02:36</span></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="co">#&gt; 2022-01-21 13:02:36</span></span>
<span id="cb3-36"><a href="#cb3-36"></a><span class="co">#&gt;   a    geometry                time</span></span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="co">#&gt; 1 1 POINT (1 2) 2022-01-21 13:02:36</span></span>
<span id="cb3-38"><a href="#cb3-38"></a><span class="co">#&gt; 2 2 POINT (1 3) 2022-01-21 13:02:36</span></span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="co">#&gt; 3 3 POINT (2 3) 2022-01-21 13:02:36</span></span>
<span id="cb3-40"><a href="#cb3-40"></a><span class="co">#&gt; 4 4 POINT (2 1) 2022-01-21 13:02:36</span></span>
<span id="cb3-41"><a href="#cb3-41"></a></span>
<span id="cb3-42"><a href="#cb3-42"></a><span class="co"># add a time column to an sf object converts it to an sftime object</span></span>
<span id="cb3-43"><a href="#cb3-43"></a><span class="kw">st_time</span>(x_sftime1, <span class="dt">time_column_name =</span> <span class="st">&quot;time&quot;</span>) &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb3-44"><a href="#cb3-44"></a><span class="kw">class</span>(x_sftime1)</span>
<span id="cb3-45"><a href="#cb3-45"></a><span class="co">#&gt; [1] &quot;sftime&quot;     &quot;sf&quot;         &quot;data.frame&quot;</span></span>
<span id="cb3-46"><a href="#cb3-46"></a></span>
<span id="cb3-47"><a href="#cb3-47"></a><span class="co"># These can also be used with pipes</span></span>
<span id="cb3-48"><a href="#cb3-48"></a>x_sftime1 &lt;-</span>
<span id="cb3-49"><a href="#cb3-49"></a><span class="st">  </span>x_sftime1 <span class="op">%&gt;%</span></span>
<span id="cb3-50"><a href="#cb3-50"></a><span class="st">  </span><span class="kw">st_drop_time</span>() <span class="op">%&gt;%</span></span>
<span id="cb3-51"><a href="#cb3-51"></a><span class="st">  </span><span class="kw">st_set_time</span>(<span class="kw">Sys.time</span>(), <span class="dt">time_column_name =</span> <span class="st">&quot;time&quot;</span>)</span></code></pre></div>
</div>
<div id="conversion-to-class-sftime" class="section level2">
<h2>Conversion to class <code>sftime</code></h2>
<p>sftime supports coercion to <code>sftime</code> objects from the following classes (grouped according to packages):</p>
<ul>
<li>sf: sf</li>
<li>stars: stars</li>
<li>spacetime: STI, STIDF</li>
<li>trajectories: Track, Tracks, TracksCollection</li>
<li>sftrack: sftrack, sftraj</li>
</ul>
<p><strong>Conversion from <code>sf</code> objects:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># define the geometry column</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>g &lt;-<span class="st"> </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span><span class="kw">st_sfc</span>(</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)), </span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)), </span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)), </span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb4-9"><a href="#cb4-9"></a>  )</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># crate sf object</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>x4_sf &lt;-<span class="st"> </span><span class="kw">st_sf</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, g, <span class="dt">time =</span> <span class="kw">Sys.time</span>() <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co"># convert to sftime</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>x4_sftime &lt;-<span class="st"> </span><span class="kw">st_as_sftime</span>(x4_sf) </span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="kw">class</span>(x4_sftime)</span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt; [1] &quot;sftime&quot;     &quot;sf&quot;         &quot;data.frame&quot;</span></span></code></pre></div>
<p><strong>Conversion from <code>stars</code> objects:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># load sample data</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>x5_stars &lt;-<span class="st"> </span>stars<span class="op">::</span><span class="kw">read_ncdf</span>(<span class="kw">system.file</span>(<span class="st">&quot;nc/bcsd_obs_1999.nc&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stars&quot;</span>), <span class="dt">var =</span> <span class="kw">c</span>(<span class="st">&quot;pr&quot;</span>, <span class="st">&quot;tas&quot;</span>))</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; No projection information found in nc file. </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;  Coordinate variable units found to be degrees, </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;  assuming WGS84 Lat/Lon.</span></span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co"># convert to sftime</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>x5_sftime &lt;-<span class="st"> </span><span class="kw">st_as_sftime</span>(x5_stars, <span class="dt">time_column_name =</span> <span class="st">&quot;time&quot;</span>)</span></code></pre></div>
<p><code>st_as_sftime.stars</code> is a wrapper around <code>st_as_sf.stars</code>. As a consequence, some dimensions of the <code>stars</code> object can be dropped during conversion. Temporal information in <code>stars</code> objects are typically stored as dimension of an attribute. Therefore, some argument settings to <code>st_as_sftime</code> can drop the dimension with temporal information and therefore throw an error. For example, setting <code>merge = TRUE</code> drops dimension <code>time</code> and therefore conversion fails. Similarly, setting <code>long = FALSE</code> returns the attribute values in a wide format, where each column is a time point:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># failed conversion to sftime</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>x5_sftime &lt;-<span class="st"> </span><span class="kw">st_as_sftime</span>(x5_stars, <span class="dt">merge =</span> <span class="ot">TRUE</span>, <span class="dt">time_column_name =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; Error in st_as_sftime.stars(x5_stars, merge = TRUE, time_column_name = &quot;time&quot;): `time_column_name` is not a column in the converted object.</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>x5_sftime &lt;-<span class="st"> </span><span class="kw">st_as_sftime</span>(x5_stars, <span class="dt">long =</span> <span class="ot">FALSE</span>, <span class="dt">time_column_name =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; Error in st_as_sftime.stars(x5_stars, long = FALSE, time_column_name = &quot;time&quot;): `time_column_name` is not a column in the converted object.</span></span></code></pre></div>
<p><strong>Conversion from <code>spacetime</code> objects</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># get sample data</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">example</span>(STI, <span class="dt">package =</span> <span class="st">&quot;spacetime&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; </span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; STI&gt; sp = cbind(x = c(0,0,1), y = c(0,1,1))</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; STI&gt; row.names(sp) = paste(&quot;point&quot;, 1:nrow(sp), sep=&quot;&quot;)</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; </span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; STI&gt; library(sp)</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; </span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt; STI&gt; sp = SpatialPoints(sp)</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt; </span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; STI&gt; time = as.POSIXct(&quot;2010-08-05&quot;)+3600*(10:13)</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; </span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; STI&gt; m = c(10,20,30) # means for each of the 3 point locations</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; </span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt; STI&gt; mydata = rnorm(length(sp)*length(time),mean=rep(m, 4))</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt; </span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt; STI&gt; IDs = paste(&quot;ID&quot;,1:length(mydata))</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt; </span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt; STI&gt; mydata = data.frame(values = signif(mydata,3), ID=IDs)</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt; </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt; STI&gt; stidf = as(STFDF(sp, time, mydata), &quot;STIDF&quot;)</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt; </span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#&gt; STI&gt; stidf[1:2,]</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">#&gt; An object of class &quot;STIDF&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">#&gt; Slot &quot;data&quot;:</span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co">#&gt;   values   ID</span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co">#&gt; 1   10.2 ID 1</span></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="co">#&gt; 2   20.3 ID 2</span></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="co">#&gt; </span></span>
<span id="cb7-31"><a href="#cb7-31"></a><span class="co">#&gt; Slot &quot;sp&quot;:</span></span>
<span id="cb7-32"><a href="#cb7-32"></a><span class="co">#&gt; SpatialPoints:</span></span>
<span id="cb7-33"><a href="#cb7-33"></a><span class="co">#&gt;        x y</span></span>
<span id="cb7-34"><a href="#cb7-34"></a><span class="co">#&gt; point1 0 0</span></span>
<span id="cb7-35"><a href="#cb7-35"></a><span class="co">#&gt; point2 0 1</span></span>
<span id="cb7-36"><a href="#cb7-36"></a><span class="co">#&gt; Coordinate Reference System (CRS) arguments: NA </span></span>
<span id="cb7-37"><a href="#cb7-37"></a><span class="co">#&gt; </span></span>
<span id="cb7-38"><a href="#cb7-38"></a><span class="co">#&gt; Slot &quot;time&quot;:</span></span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="co">#&gt;                     timeIndex</span></span>
<span id="cb7-40"><a href="#cb7-40"></a><span class="co">#&gt; 2010-08-05 10:00:00         1</span></span>
<span id="cb7-41"><a href="#cb7-41"></a><span class="co">#&gt; 2010-08-05 10:00:00         1</span></span>
<span id="cb7-42"><a href="#cb7-42"></a><span class="co">#&gt; </span></span>
<span id="cb7-43"><a href="#cb7-43"></a><span class="co">#&gt; Slot &quot;endTime&quot;:</span></span>
<span id="cb7-44"><a href="#cb7-44"></a><span class="co">#&gt; [1] &quot;2010-08-05 11:00:00 CEST&quot; &quot;2010-08-05 11:00:00 CEST&quot;</span></span>
<span id="cb7-45"><a href="#cb7-45"></a><span class="co">#&gt; </span></span>
<span id="cb7-46"><a href="#cb7-46"></a><span class="co">#&gt; </span></span>
<span id="cb7-47"><a href="#cb7-47"></a><span class="co">#&gt; STI&gt; all.equal(stidf, stidf[stidf,])</span></span>
<span id="cb7-48"><a href="#cb7-48"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb7-49"><a href="#cb7-49"></a><span class="kw">class</span>(stidf)</span>
<span id="cb7-50"><a href="#cb7-50"></a><span class="co">#&gt; [1] &quot;STIDF&quot;</span></span>
<span id="cb7-51"><a href="#cb7-51"></a><span class="co">#&gt; attr(,&quot;package&quot;)</span></span>
<span id="cb7-52"><a href="#cb7-52"></a><span class="co">#&gt; [1] &quot;spacetime&quot;</span></span>
<span id="cb7-53"><a href="#cb7-53"></a></span>
<span id="cb7-54"><a href="#cb7-54"></a><span class="co"># conversion to sftime</span></span>
<span id="cb7-55"><a href="#cb7-55"></a>x1_sftime &lt;-<span class="st"> </span><span class="kw">st_as_sftime</span>(stidf)</span></code></pre></div>
<p><strong>Conversion from <code>Track</code>, <code>Tracks</code>, <code>TracksCollections</code> objects (trajectories package)</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># get a sample TracksCollection</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>x2_TracksCollection &lt;-<span class="st"> </span>trajectories<span class="op">::</span><span class="kw">rTracksCollection</span>(<span class="dt">p =</span> <span class="dv">2</span>, <span class="dt">m =</span> <span class="dv">3</span>, <span class="dt">n =</span> <span class="dv">40</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># convert to sftime</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>x2_TracksCollection_sftime &lt;-<span class="st"> </span><span class="kw">st_as_sftime</span>(x2_TracksCollection)</span>
<span id="cb8-6"><a href="#cb8-6"></a>x2_Tracks_sftime &lt;-<span class="st"> </span><span class="kw">st_as_sftime</span>(x2_TracksCollection<span class="op">@</span>tracksCollection[[<span class="dv">1</span>]])</span>
<span id="cb8-7"><a href="#cb8-7"></a>x2_Track_sftime &lt;-<span class="st"> </span><span class="kw">st_as_sftime</span>(x2_TracksCollection<span class="op">@</span>tracksCollection[[<span class="dv">1</span>]]<span class="op">@</span>tracks[[<span class="dv">1</span>]])</span></code></pre></div>
</div>
<div id="subsetting" class="section level2">
<h2>Subsetting</h2>
<p>Different subsetting methods exist for <code>sftime</code> objects. Since <code>sftime</code> objects are built on top of <code>sf</code> objects, all subsetting methods for <code>sf</code> objects also work for <code>sftime</code> objects.</p>
</div>
<div id="plotting" class="section level2">
<h2>Plotting</h2>
<p>One of the first thing to do after a data set has been created, is to inspect it by plotting it. Plotting an 3+ dimensional object is always a projection of selected dimensions. The following plotting abilities are provided in <code>sftime</code> through the mode argument (just as in <code>spacetime::stplot</code>). Depending on the nature of the data/underlying processes, some options might not lead to useful visualizations:</p>
<ul>
<li><code>&quot;xy&quot;</code>: maps for time ranges are plotted, ranges can be defined or will be equally distributed. Geometries might be overlaid several times when multiple times fall in the same selected range.</li>
<li><code>&quot;xt&quot;</code>: a space-time plot is constructed, this might lead to a straight line along the main diagonal in case not two geometries are recorded for the same time stamp nor are geometries recorded more than once.</li>
<li><code>&quot;ts&quot;</code>: multiple-locations time series are plotted in a single plot, or in a separate panel for each attribute</li>
<li><code>&quot;tp&quot;</code>: single- or multi-attribute time series are plotted in multiple panels, one panel per location.</li>
</ul>
<p>Examples for <code>mode=&quot;xy&quot;</code>, the default:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>coords &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">100</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>g =<span class="st"> </span><span class="kw">st_sfc</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="cf">function</span>(i) <span class="kw">st_point</span>(coords[i,]) ))</span>
<span id="cb9-3"><a href="#cb9-3"></a>sft &lt;-<span class="st"> </span><span class="kw">st_sftime</span>(<span class="dt">a=</span><span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, g, <span class="dt">time =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2020-09-01 00:00:00&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">49</span> <span class="op">*</span><span class="st"> </span><span class="dv">3600</span> <span class="op">*</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="kw">plot</span>(sft, <span class="dt">key.pos =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">plot</span>(sft, <span class="dt">number =</span> <span class="dv">10</span>, <span class="dt">max.plot =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="old-stuff" class="section level1">
<h1>Old stuff</h1>
<div id="the-time-column" class="section level2">
<h2>The time column</h2>
<p>The time column is a special column of the underlying sf object which defines time information (timestamps and temporal ordering) alongside the simple features column of an sf object. Common time representations in R (e.g. “POSIXct”, “POSIXlt”, “Date”, “yearmon”, “yearqtr”, “factor”) are allowed, as well as optional user defined types. Lets look at a simple example where we define a time column based on “POSIXct”</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">library</span>(sftime)</span>
<span id="cb11-2"><a href="#cb11-2"></a>tc &lt;-<span class="st"> </span><span class="kw">st_tc</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;2020-09-01 08:00:00&quot;</span>)<span class="op">-</span><span class="dv">0</span><span class="op">:</span><span class="dv">3</span><span class="op">*</span><span class="dv">3600</span><span class="op">*</span><span class="dv">24</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a>tc</span></code></pre></div>
<p>The ordering is not altered upon construction (as in some other representations). If a different order is required, the “order” and “sort” functions can be applied to the time column:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>tc[<span class="dv">1</span>]</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">order</span>(tc)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="kw">sort</span>(tc)</span></code></pre></div>
<p>In some applications it might be useful to have more complex temporal information such as intervals of different length. The following example is also meant as template for other user defined classes which could be used to build the time column of the sftime class.</p>
<p>At first, we will need a few helper functions:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># utility functions</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>as.character.interval &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="kw">paste0</span>(<span class="st">&quot;[&quot;</span>, x[<span class="dv">1</span>], <span class="st">&quot;, &quot;</span>, x[<span class="dv">2</span>], <span class="st">&quot;]&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4"></a>}</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>print.interval&lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="kw">cat</span>(<span class="st">&quot;Interval:&quot;</span>, <span class="kw">as.character</span>(x))</span>
<span id="cb13-8"><a href="#cb13-8"></a>}</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="st">&#39;[.intervals&#39;</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {</span>
<span id="cb13-11"><a href="#cb13-11"></a>  sx &lt;-<span class="st"> </span><span class="kw">unclass</span>(x)[i]</span>
<span id="cb13-12"><a href="#cb13-12"></a>  <span class="kw">class</span>(sx) &lt;-<span class="st"> &quot;intervals&quot;</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>  sx</span>
<span id="cb13-14"><a href="#cb13-14"></a>}</span></code></pre></div>
<p>Now, we can define the different intervals used to represent our temporal information:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># time interval definition</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>i1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">5.3</span>,<span class="dv">12</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw">class</span>(i1) &lt;-<span class="st"> &quot;interval&quot;</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>i2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.1</span>,<span class="dv">6</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="kw">class</span>(i2) &lt;-<span class="st"> &quot;interval&quot;</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>i3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.4</span>,<span class="fl">6.9</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="kw">class</span>(i3) &lt;-<span class="st"> &quot;interval&quot;</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>i4 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">21</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="kw">class</span>(i4) &lt;-<span class="st"> &quot;interval&quot;</span></span>
<span id="cb14-10"><a href="#cb14-10"></a></span>
<span id="cb14-11"><a href="#cb14-11"></a>intrvls &lt;-<span class="st"> </span><span class="kw">list</span>(i1, i2, i3, i4)</span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="kw">class</span>(intrvls) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;intervals&quot;</span>, <span class="kw">class</span>(intrvls))</span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co"># provide dedicated generic to xtfrm for class intervals</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>xtfrm.intervals &lt;-<span class="st"> </span><span class="cf">function</span>(is) <span class="kw">sapply</span>(is, xtfrm)</span></code></pre></div>
<p>The advantage is to be able to define different sorting approaches:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># - sort by centre</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>xtfrm.interval &lt;-<span class="st"> </span><span class="cf">function</span>(i) <span class="kw">mean</span>(i)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>tc &lt;-<span class="st"> </span><span class="kw">st_tc</span>(intrvls)</span>
<span id="cb15-5"><a href="#cb15-5"></a>tc</span>
<span id="cb15-6"><a href="#cb15-6"></a>tc[<span class="dv">1</span>]</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="kw">order</span>(tc)</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="kw">sort</span>(tc)[<span class="dv">1</span>]</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># - sort by end</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>xtfrm.interval &lt;-<span class="st"> </span><span class="cf">function</span>(i) i[<span class="dv">2</span>]</span>
<span id="cb16-3"><a href="#cb16-3"></a>tc &lt;-<span class="st"> </span><span class="kw">st_tc</span>(intrvls)</span>
<span id="cb16-4"><a href="#cb16-4"></a>tc</span>
<span id="cb16-5"><a href="#cb16-5"></a>tc[<span class="dv">1</span>]</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="kw">order</span>(tc)</span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="kw">sort</span>(tc)[<span class="dv">1</span>]</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># - sort by start</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>xtfrm.interval &lt;-<span class="st"> </span><span class="cf">function</span>(i) i[<span class="dv">1</span>]</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a>tc &lt;-<span class="st"> </span><span class="kw">st_tc</span>(intrvls)</span>
<span id="cb17-5"><a href="#cb17-5"></a>tc</span>
<span id="cb17-6"><a href="#cb17-6"></a>tc[<span class="dv">1</span>]</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="kw">order</span>(tc)</span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="kw">sort</span>(tc)[<span class="dv">1</span>]</span></code></pre></div>
<p>Based on the sorting procedure (begin, centre or end of the interval), the smallest element (each last line) and the order of the time column changes.</p>
</div>
<div id="the-sftime-class-1" class="section level2">
<h2>The sftime class</h2>
<p>An <code>sftime</code> object is an <code>sf</code> object with an additional time column which contains the temporal information alongside the simple features column. This allows it to handle irregular and regular temporal information.</p>
<p>For spatiotemporal data with regular temporal data, the package stars is developed as a powerful alternative (e.g. time series of remote sensing imagery, regular measurements of entire measurement network).</p>
<p>sftime objects can be constructed based on sf objects:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a></span>
<span id="cb18-2"><a href="#cb18-2"></a>g =<span class="st"> </span><span class="kw">st_sfc</span>(<span class="kw">st_point</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>), <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)), <span class="kw">st_point</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>), <span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)))</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co"># provide as.data.frame method. This is needed for sf::st_sf to not cause an error with lists when calling as.data.frame</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>as.data.frame.intervals &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {</span>
<span id="cb18-6"><a href="#cb18-6"></a>  nm &lt;-<span class="st"> </span><span class="kw">deparse1</span>(<span class="kw">substitute</span>(x))</span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="st">&quot;nm&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(<span class="kw">list</span>(...))) </span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="kw">as.data.frame.vector</span>(x, ..., <span class="dt">nm =</span> nm)</span>
<span id="cb18-9"><a href="#cb18-9"></a>  <span class="cf">else</span> <span class="kw">as.data.frame.vector</span>(x, ...)</span>
<span id="cb18-10"><a href="#cb18-10"></a>}</span>
<span id="cb18-11"><a href="#cb18-11"></a></span>
<span id="cb18-12"><a href="#cb18-12"></a>sft &lt;-<span class="st"> </span><span class="kw">st_sftime</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, g, <span class="dt">time =</span> <span class="kw">sort</span>(tc))</span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a>sft &lt;-<span class="st"> </span><span class="kw">st_sftime</span>(g, <span class="dt">time =</span> <span class="kw">st_tc</span>(<span class="kw">Sys.time</span>()<span class="op">-</span><span class="dv">0</span><span class="op">:</span><span class="dv">3</span><span class="op">*</span><span class="dv">3600</span><span class="op">*</span><span class="dv">24</span>))</span></code></pre></div>
<p>This is the very beginning there is more to come.</p>
</div>
<div id="coercion" class="section level2">
<h2>coercion</h2>
</div>
<div id="sub-setting" class="section level2">
<h2>sub-setting</h2>
</div>
<div id="plotting-1" class="section level2">
<h2>plotting</h2>
<p>One of the first thing to do after a data set has been created, is to inspect it by plotting it. Plotting an 3+ dimensional onject is always a projection of selected dimensions. The following plotting abilities are provided in <code>sftime</code> through the mode argument (just as in <code>spacetime::stplot</code>). Depending on the nature of the data/underlying processes, some options might not lead to useful visulaisations:</p>
<ul>
<li><code>&quot;xy&quot;</code>: maps for time ranges are plotted, ranges can be defined or will be equally distributed. Geometries might be overlaid several times when multiple times fall in the same selected range.</li>
<li><code>&quot;xt&quot;</code>: a space-time plot is constructed, this might lead to a straight line along the main diagonal in case not two geometries are recorded for the same time stamp nor are geometries recorded more than once.</li>
<li><code>&quot;ts&quot;</code>: multiple-locations time series are plotted in a single plot, or in a separate panel for each attribute</li>
<li><code>&quot;tp&quot;</code>: single- or multi-attribute time series are plotted in multiple panels, one panel per location.</li>
</ul>
<p>Examples for <code>mode=&quot;xy&quot;</code>, the default:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>coords &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">100</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>g =<span class="st"> </span><span class="kw">st_sfc</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="cf">function</span>(i) <span class="kw">st_point</span>(coords[i,]) ))</span>
<span id="cb19-3"><a href="#cb19-3"></a>sf &lt;-<span class="st"> </span><span class="kw">st_sf</span>(<span class="dt">a=</span><span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, g)</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a>sft &lt;-<span class="st"> </span><span class="kw">st_sftime</span>(<span class="kw">cbind</span>(sf, <span class="dt">time =</span> <span class="kw">st_tc</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;2020-09-01 00:00:00&quot;</span>)<span class="op">+</span><span class="dv">0</span><span class="op">:</span><span class="dv">49</span><span class="op">*</span><span class="dv">3600</span><span class="op">*</span><span class="dv">6</span>)))</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="kw">plot</span>(sft, <span class="dt">key.pos =</span> <span class="dv">4</span>)</span>
<span id="cb19-8"><a href="#cb19-8"></a></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="kw">plot</span>(sft, <span class="dt">number=</span><span class="dv">10</span>, <span class="dt">max.plot=</span><span class="dv">10</span>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
